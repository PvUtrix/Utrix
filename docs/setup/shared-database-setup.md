# üóÑÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –µ–¥–∏–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

## –û–±–∑–æ—Ä
–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É **–µ–¥–∏–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL** –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –≤–∫–ª—é—á–∞—è Gitea, Coolify –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –µ–¥–∏–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** - –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ –∏ CPU  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** - –æ–¥–Ω–∞ —Ç–æ—á–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è  
‚úÖ **–ï–¥–∏–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ  
‚úÖ **–ö—Ä–æ—Å—Å-—Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è** - –º–µ–Ω—å—à–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è  

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     Gitea      ‚îÇ    ‚îÇ    Coolify      ‚îÇ    ‚îÇ   –î—Ä—É–≥–∏–µ       ‚îÇ
‚îÇ   (Git-—Å–µ—Ä–≤–µ—Ä) ‚îÇ    ‚îÇ  (–î–µ–ø–ª–æ–π)       ‚îÇ    ‚îÇ   –°–µ—Ä–≤–∏—Å—ã      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                      ‚îÇ                      ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   –ï–¥–∏–Ω–∞—è PostgreSQL      ‚îÇ
                    ‚îÇ   –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö            ‚îÇ
                    ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
                    ‚îÇ   ‚îÇ –°—Ö–µ–º–∞: gitea        ‚îÇ ‚îÇ
                    ‚îÇ   ‚îÇ –°—Ö–µ–º–∞: coolify      ‚îÇ ‚îÇ
                    ‚îÇ   ‚îÇ –°—Ö–µ–º–∞: monitoring   ‚îÇ ‚îÇ
                    ‚îÇ   ‚îÇ –°—Ö–µ–º–∞: logs         ‚îÇ ‚îÇ
                    ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ –µ–¥–∏–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL

```bash
# –í Coolify —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å PostgreSQL
docker run -d \
  --name shared-postgres \
  --network personal-system-network \
  -e POSTGRES_DB=personal_system_db \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=secure_password_123 \
  -v postgres_data:/var/lib/postgresql/data \
  -p 5432:5432 \
  postgres:15-alpine
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ö–µ–º—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```sql
-- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
psql -h localhost -U postgres -d personal_system_db

-- –°–æ–∑–¥–∞–π—Ç–µ —Å—Ö–µ–º—ã –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
CREATE SCHEMA IF NOT EXISTS gitea;
CREATE SCHEMA IF NOT EXISTS coolify;
CREATE SCHEMA IF NOT EXISTS monitoring;
CREATE SCHEMA IF NOT EXISTS logs;

-- –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
CREATE USER gitea_user WITH PASSWORD 'gitea_password';
CREATE USER coolify_user WITH PASSWORD 'coolify_password';

-- –ù–∞–∑–Ω–∞—á—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Å—Ö–µ–º—ã
GRANT USAGE ON SCHEMA gitea TO gitea_user;
GRANT ALL PRIVILEGES ON SCHEMA gitea TO gitea_user;

GRANT USAGE ON SCHEMA coolify TO coolify_user;
GRANT ALL PRIVILEGES ON SCHEMA coolify TO coolify_user;
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Gitea –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –µ–¥–∏–Ω–æ–π –±–∞–∑—ã

```yaml
# –í –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Gitea
GITEA__database__DB_TYPE: postgres
GITEA__database__HOST: shared-postgres
GITEA__database__NAME: personal_system_db
GITEA__database__USER: gitea_user
GITEA__database__PASSWD: gitea_password
GITEA__database__PORT: 5432
GITEA__database__SCHEMA: gitea
```

## ‚öôÔ∏è –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
SHARED_DB_HOST=localhost
SHARED_DB_PORT=5432
SHARED_DB_NAME=personal_system_db
SHARED_DB_USER=postgres
SHARED_DB_PASSWORD=secure_password_123

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Redis
SHARED_REDIS_HOST=localhost
SHARED_REDIS_PORT=6379
SHARED_REDIS_PASSWORD=redis_password_123

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Gitea
GITEA_DOMAIN=git.yourdomain.com
GITEA_SECRET_KEY=your-secret-key-here
GITEA_INTERNAL_TOKEN=your-internal-token-here
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Coolify

1. **–°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å PostgreSQL:**
   - –ò–º—è: `shared-postgres`
   - –ü–æ—Ä—Ç: `5432`
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `personal_system_db`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `postgres`
   - –ü–∞—Ä–æ–ª—å: `secure_password_123`

2. **–°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
   - –ò–º—è: `shared-redis`
   - –ü–æ—Ä—Ç: `6379`
   - –ü–∞—Ä–æ–ª—å: `redis_password_123`

3. **–°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å Gitea:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ `config/automation/gitea-shared-db.yaml`
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ –æ–±—â–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

### Gitea

```yaml
# config/automation/gitea-shared-db.yaml
gitea:
  container:
    environment:
      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö - –ò–°–ü–û–õ–¨–ó–£–ï–ú –ï–î–ò–ù–£–Æ –ë–ê–ó–£
      GITEA__database__DB_TYPE: postgres
      GITEA__database__HOST: shared-postgres
      GITEA__database__NAME: personal_system_db
      GITEA__database__USER: gitea_user
      GITEA__database__PASSWD: gitea_password
      GITEA__database__PORT: 5432
      GITEA__database__SCHEMA: gitea
      
      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Redis
      GITEA__cache__ADAPTER: redis
      GITEA__cache__HOST: shared-redis
      GITEA__cache__PORT: 6379
      GITEA__cache__PASSWORD: redis_password_123
```

### Coolify

```yaml
# –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Coolify
database:
  type: postgres
  host: shared-postgres
  port: 5432
  name: personal_system_db
  user: coolify_user
  password: coolify_password
  schema: coolify
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### Prometheus –º–µ—Ç—Ä–∏–∫–∏

```yaml
# postgres-exporter –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
postgres-exporter:
  image: prometheuscommunity/postgres-exporter:latest
  environment:
    DATA_SOURCE_NAME: "postgresql://postgres:password@shared-postgres:5432/personal_system_db?sslmode=disable"
  ports:
    - "9187:9187"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è

```yaml
healthcheck:
  database:
    test: ["CMD-SHELL", "pg_isready -U postgres"]
    interval: 30s
    timeout: 10s
    retries: 3
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```sql
-- –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ—é —Å—Ö–µ–º—É
-- Gitea: —Å—Ö–µ–º–∞ 'gitea'
-- Coolify: —Å—Ö–µ–º–∞ 'coolify'
-- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: —Å—Ö–µ–º–∞ 'monitoring'

-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Å–≤–æ–∏–º —Å—Ö–µ–º–∞–º
GRANT USAGE ON SCHEMA gitea TO gitea_user;
GRANT ALL PRIVILEGES ON SCHEMA gitea TO gitea_user;
```

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

```yaml
# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –≤–∫–ª—é—á–∏—Ç–µ SSL
GITEA__database__SSL_MODE: require
GITEA__database__SSL_CERT: /path/to/cert
GITEA__database__SSL_KEY: /path/to/key
GITEA__database__SSL_CA: /path/to/ca
```

## üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
#!/bin/bash
# backup-database.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backups/database"

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
pg_dump -h localhost -U postgres -d personal_system_db \
  --format=custom --verbose \
  --file="$BACKUP_DIR/full_backup_$DATE.dump"

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ö–µ–º
pg_dump -h localhost -U postgres -d personal_system_db \
  --schema=gitea --format=custom \
  --file="$BACKUP_DIR/gitea_schema_$DATE.dump"

pg_dump -h localhost -U postgres -d personal_system_db \
  --schema=coolify --format=custom \
  --file="$BACKUP_DIR/coolify_schema_$DATE.dump"

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.dump" -mtime +30 -delete
```

### Cron –∑–∞–¥–∞—á–∞

```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab
0 2 * * * /path/to/backup-database.sh >> /var/log/backup.log 2>&1
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
pg_dump -h old_gitea_host -U old_user -d old_gitea_db > gitea_backup.sql
pg_dump -h old_coolify_host -U old_user -d old_coolify_db > coolify_backup.sql

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ –Ω–æ–≤—É—é –µ–¥–∏–Ω—É—é –±–∞–∑—É
psql -h localhost -U postgres -d personal_system_db -c "CREATE SCHEMA gitea;"
psql -h localhost -U postgres -d personal_system_db -c "CREATE SCHEMA coolify;"

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ö–µ–º—ã
psql -h localhost -U postgres -d personal_system_db -f gitea_backup.sql
psql -h localhost -U postgres -d personal_system_db -f coolify_backup.sql
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL

```sql
-- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –µ–¥–∏–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
ALTER SYSTEM SET shared_buffers = '256MB';
ALTER SYSTEM SET effective_cache_size = '1GB';
ALTER SYSTEM SET maintenance_work_mem = '64MB';
ALTER SYSTEM SET checkpoint_completion_target = 0.9;
ALTER SYSTEM SET wal_buffers = '16MB';
ALTER SYSTEM SET default_statistics_target = 100;

-- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
SELECT pg_reload_conf();
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ö–µ–º
SELECT 
  schemaname,
  pg_size_pretty(pg_total_relation_size(schemaname||'.*')) as size
FROM pg_schema
WHERE schemaname IN ('gitea', 'coolify', 'monitoring', 'logs');

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
SELECT 
  datname,
  usename,
  application_name,
  client_addr,
  state
FROM pg_stat_activity
WHERE datname = 'personal_system_db';
```

## üÜò Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
pg_isready -h localhost -p 5432 -U postgres

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
psql -h localhost -U postgres -d personal_system_db -c "SELECT version();"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ PostgreSQL
docker logs shared-postgres
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT 
  schemaname,
  tablename,
  tableowner,
  hasinsert,
  hasselect,
  hasupdate,
  hasdelete
FROM pg_tables
WHERE schemaname IN ('gitea', 'coolify');

-- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤
GRANT ALL PRIVILEGES ON SCHEMA gitea TO gitea_user;
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA gitea TO gitea_user;
GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA gitea TO gitea_user;
```

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
psql -h localhost -U postgres -d personal_system_db

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
pg_dump -h localhost -U postgres -d personal_system_db > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
psql -h localhost -U postgres -d personal_system_db < backup.sql

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
psql -h localhost -U postgres -d personal_system_db -c "SELECT pg_size_pretty(pg_database_size('personal_system_db'));"
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Docker

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f docker-compose.shared-db.yml up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f docker-compose.shared-db.yml down

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose -f docker-compose.shared-db.yml logs -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose -f docker-compose.shared-db.yml restart gitea
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –µ–¥–∏–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ö–µ–º—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
6. üîÑ –ú–∏–≥—Ä–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
7. üîÑ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ï–¥–∏–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –∏–∑–æ–ª—è—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å—Ö–µ–º–∞–º, —É–ø—Ä–æ—â–µ–Ω–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º.
